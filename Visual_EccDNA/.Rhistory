theme(legend.position="none")+
ylim(-100,50)+
coord_polar(start=0)
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr1", 664053, 664181))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.7))+
scale_fill_discrete(values=c("A"="red","T"="green","G"="yellow","C"="blue"))
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr1", 664053, 664181))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.7))+
scale_fill_manual(values=c("A"="red","T"="green","G"="yellow","C"="blue"))
theme(legend.position="none")+
ylim(-100,50)+
coord_polar(start=0)
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr1", 664053, 664181))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="red","T"="green","G"="yellow","C"="blue"))+
theme(legend.position="none")+
ylim(-100,50)+
coord_polar(start=0)
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr1", 664053, 664181))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
theme(legend.position="none")+
ylim(-100,50)+
coord_polar(start=0)
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr1", 664053, 664181))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
theme(legend.position="none")+
ylim(-100,50)+
coord_polar(start=0)+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr1", 664053, 664181))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
ylim(-100,50)+
coord_polar(start=0)+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),legend.position="none")
View(circ)
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr2", 19206729, 19210302))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
ylim(-100,50)+
coord_polar(start=0)+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),legend.position="none")
ggplot(data, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=category)) +
geom_rect() +
geom_label( x=3.5, aes(y=labelPosition, label=label), size=6) +
scale_fill_brewer(palette=4) +
coord_polar(theta="y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "none")
# Create test data.
data <- data.frame(
category=c("A", "B", "C"),
count=c(10, 60, 30)
)
# Compute percentages
data$fraction <- data$count / sum(data$count)
# Compute the cumulative percentages (top of each rectangle)
data$ymax <- cumsum(data$fraction)
# Compute the bottom of each rectangle
data$ymin <- c(0, head(data$ymax, n=-1))
# Compute label position
data$labelPosition <- (data$ymax + data$ymin) / 2
# Compute a good label
data$label <- paste0(data$category, "\n value: ", data$count)
ggplot(data, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=category)) +
geom_rect() +
geom_label( x=3.5, aes(y=labelPosition, label=label), size=6) +
scale_fill_brewer(palette=4) +
coord_polar(theta="y") +
xlim(c(2, 4)) +
theme_void() +
theme(legend.position = "none")
install.packages("usethis")
install.packages(c("bslib", "sass"))
devtools::document()
install.packages('rsconnect')
rsconnect::setAccountInfo(name='agarcia18',
token='931ED152CDC49361415E74448D665357',
secret='rr7a0ZVjh2j2RDO7oAfiCRn2ZKnjgUP+P1Q0Fjpy')
library(rsconnect)
rsconnect::deployApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
bioc <- local({
env <- new.env()
on.exit(rm(env))
evalq(source("http://bioconductor.org/biocLite.R", local = TRUE), env)
biocinstallRepos()
})
bioc
bioc <- local({
env <- new.env()
on.exit(rm(env))
evalq(source("http://bioconductor.org/biocLite.R", local = TRUE), env)
biocinstallRepos()
})
bioc <- local({
env <- new.env()
on.exit(rm(env))
evalq(source("http://bioconductor.org/biocManager.R", local = TRUE), env)
biocinstallRepos()
})
bioc
local({
r <- getOption("repos")
r["CRAN"] <- "https://cran.rstudio.com/"
r["BioCsoft"] <- "https://bioconductor.org/packages/3.7/bioc"
r["BioCann"] <- "https://bioconductor.org/packages/3.7/data/annotation"
r["BioCexp"] <- "https://bioconductor.org/packages/3.7/data/experiment"
options(repos = r)
})
bioc <-local({
r <- getOption("repos")
r["CRAN"] <- "https://cran.rstudio.com/"
r["BioCsoft"] <- "https://bioconductor.org/packages/3.7/bioc"
r["BioCann"] <- "https://bioconductor.org/packages/3.7/data/annotation"
r["BioCexp"] <- "https://bioconductor.org/packages/3.7/data/experiment"
options(repos = r)
})
bioc
sessionInfo()
library(rsconnect)
rsconnect::deployApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
library(rsconnect)
rsconnect::deployApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
options('repos')
options('repos')
rsconnect::deployApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
rsconnect::deployApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
r["BioCexp"] <- "https://bioconductor.org/packages/3.12/data/experiment"
local({
r <- getOption("repos")
r["CRAN"] <- "https://cran.rstudio.com/"
r["BioCsoft"] <- "https://bioconductor.org/packages/3.12/bioc"
r["BioCann"] <- "https://bioconductor.org/packages/3.12/data/annotation"
r["BioCexp"] <- "https://bioconductor.org/packages/3.12/data/experiment"
options(repos = r)
})
rsconnect::deployApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
library(GenomicFeatures)
hg19.refseq.db <- makeTxDbFromUCSC(genome="hg19", table="refGene")
refseq.genes<- genes(hg19.refseq.db)
genes <-genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(shiny)
library(shinydashboard)
library(tidyverse)
library(plotly)
library(DT)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(GenomicRanges)
library(org.Hs.eg.db)
library(RITANdata)
library(RITAN)
library(shiny)
library(shinydashboard)
library(tidyverse)
library(plotly)
library(DT)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(GenomicRanges)
library(org.Hs.eg.db)
library(RITANdata)
library(RITAN)
genes <-genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
View(genes)
genes
genes
BiocManager::install("bedtools")
install.packages(c("cachem", "lme4", "tibble", "xfun"))
install.packages(c("cachem", "lme4", "tibble", "xfun"))
install.packages(c("cachem", "lme4", "tibble", "xfun"))
install.packages(c("cachem", "lme4", "tibble", "xfun"))
install.packages(c("cachem", "lme4", "tibble", "xfun"))
library(bumphunter)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
library(bumphunter)
library(dplyr)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
library(bumphunter)
library(tidyverse)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==1 & size_bp==237552813 & split_reads==6888)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
genes <-genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==1 & size_bp==237552813 & split_reads==6888)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
genes <-genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
matchGenes(coords, genes, type = c("any", "fiveprime"), promoterDist = 2500, skipExons = FALSE, verbose = TRUE)
matchGenes(coords, genes)
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==1 & size_bp==237552813 & split_reads==6888)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
genes <- annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene)
matchGenes(coords, genes)
View(circ)
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==1 & size_bp==
21180703 & split_reads==21181897)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==1 & size_bp==21180703 & split_reads==21181897)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==2 & size_bp==196961879 & split_reads==196962010)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==2 & size_bp==196961879 & split_reads==196962010)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
selected_circle <- circ %>% dplyr::filter (chrom==12 & size_bp==4138 & split_reads==10)
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==12 & size_bp==4138 & split_reads==10)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
genes <- annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene)
matchGenes(coords, genes)
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==9 & size_bp==1046 & split_reads==1433)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
genes <- annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene)
matchGenes(coords, genes)
View(circ)
library(bumphunter)
library(tidyverse)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
circ <- as.data.frame(read.table("C:/Users/ainho/eccDNA/BED/SRR6315424_unknown_circle.bed",header = FALSE, sep="\t",stringsAsFactors=FALSE))
names(circ) <- c("chrom","start","end","discordant_reads","split_reads","score","coverage_mean","coverage_sd","coverage_start", "coverage_end","coverage_cont")
# Add quality levels (score < 10 = Bad, score < 50 = Low, score < 200 = Medium, score > 200 = Good)
circ$quality <- cut(circ$score,breaks=c(-Inf,10,50,200,Inf),labels= c("Bad","Low", "Medium", "Good"),right = FALSE)
# Set chr as factor
circ$chrom <- substr(circ$chr, start = 1, stop = 5)
circ$chrom<-str_remove(circ$chr,"_")
circ$chrom<-str_remove(circ$chr,"chr")
circ$chrom <- factor(circ$chr, levels = c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","Un","M","X","Y"))
# Add circle id
circ <- circ %>% dplyr::mutate(circle_id = 1:n()) %>% dplyr::select(circle_id, everything())
# Add size of circle (number of bp)
circ$size_bp <- circ$end - circ$start
selected_circle <- circ %>% dplyr::filter (chrom==1 & size_bp==126835743 & split_reads==60)
coords <- selected_circle %>% dplyr::select(chrom,start,end) %>% makeGRangesFromDataFrame
genes <- annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene)
matchGenes(coords, genes)
View(selected_circle)
coords1<-c(chr1,91726323,91870394)
coords1<-c("chr1",91726323,91870394)
coords1<-GRanges("chr1",91726323,91870394)
coords1<-GRanges(c("chr1",91726323,91870394))
coords1<-GRanges("chr1:91726323-91870394")
genes <- annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene)
genes <- annotateTranscripts(TxDb.Hsapiens.UCSC.hg19.knownGene)
matchGenes(coords, genes)
library(GenomicRanges)
coords1<-GRanges("chr1:91726323-91870394")
genes <-genes(TxDb.Hsapiens.UCSC.hg19.knownGene)
genes_df <- as.data.frame(subsetByOverlaps(genes,coords1))
View(genes_df)
View(genes_df)
genes_df
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.character(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr2", 19206729, 19210302))
my.dnastring$position <- c(1:length(my.dnastring$x))
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr2", 19206729, 19210302))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
ylim(-100,50)+
coord_polar(start=0)+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),legend.position="none")
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr2", 19206729, 19210302))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2, position = position_dodge(0.2))+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
ylim(-100,50)+
coord_polar(start=0)+
theme_void() +
theme(legend.position = "none")
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, "chr2", 19206729, 19210302))
my.dnastring$position <- c(1:length(my.dnastring$x))
my.dnastring$value <- rep(50,length(my.dnastring$x))
my.dnastring
library(ggplot2)
ggplot(my.dnastring,aes(x=position,y=value,fill=x))+
geom_bar(stat="identity",width = 0.2)+
scale_fill_manual(values=c("A"="#E74C3C","T"="#8ADF0F","G"="#F4D03F","C"="#1F618D"))+
ylim(-100,50)+
coord_polar(start=0)+
theme_void() +
theme(legend.position = "none")
View(selected_circle)
shiny::runApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
my.dnastring <- as.data.frame(Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, chrom , start, end))
selected_circ<-circ %>% dplyr::filter (chrom==chrom_filter_small & size_bp==size_filter_small & split_reads==sr_filter_small)
chrom <- paste0("chr",selected_circle[,2])
runApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg19)
my.dnastring <- Biostrings::getSeq(BSgenome.Hsapiens.UCSC.hg19, paste0("chr",selected_circle[,2]), selected_circle[,3], selected_circle[,4])
alphabetFrequency(my.dnastring)
runApp('C:/Users/ainho/eccDNA/Visual_EccDNA')
